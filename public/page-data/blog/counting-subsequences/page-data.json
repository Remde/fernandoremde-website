{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/counting-subsequences/","result":{"data":{"site":{"siteMetadata":{"title":"Fernando's Website"}},"markdownRemark":{"id":"1530103e-3ce0-5764-8352-063d6d1d67e1","excerpt":"Answer: 4. The matches are: [s0,s11,s12], [s10,s11,s15], [s10, s14, s15], [s13,s14,s15]. This creates our look-up table. Using the main example, we’ll have…","html":"<p>I found this problem this week and found it very interesting. Well... To be honest, at first glance, I found it intimidating.\n<h3>The problem</h3>\n<p>Given two strings, s1 and s2, how many subsequences of s1 are equal to s2? Example:</p>\n<p>s1 = ABCABC, s2 = ABC\n<p>Answer: 4.</p>\n<p>The matches are: [s[0],s1[1],s1[2]], [s1[0],s1[1],s1[5]], [s1[0], s1[4], s1[5]], [s1[3],s1[4],s1[5]].</p></p>\n<p>I will refer to this example as \"main example\" throughout this explanation.</p>\n<h3>Intuition</h3>\n<p>I broke up this problem in two situations. Either the last digit was the same or it wasn't.</p>\n<p>If it wasn't the same, we could search for subsequences ignoring the last digit in s1. For instance, if s1 = ABCABCD and s2 = ABC, there wouldn't be any difference from the main example. The answer would still be 4, and the indexes the same. So we could ignore the D and look for solutions in the rest of the string.</p>\n<p>The second case is a bit more tricky. When last digit is the same for both strings, we have again two situations. You either USE the last digit of string1 or you don't. For instance, in the first array of the solution for the main example, we didn't use the last digit, s[5]. In this case, we do just like we did before. We ignore it and look for solutions in (string1.length - 1). For the other three we did, so in this case we look for the rest of the solution in (string1.length-1) and (string2.length-1).</p>\n<p>This is the complicated part. Read as many times as needed. When you truly understand this the rest of the problem comes very easily.</p>\n<h3>Exponential solution</h3>\n<p>There's a recursive, exponential solution to this problem that came quickly to me. I won't be going through it because I didn't think it was acceptable. It follows the same intuition as the dynamic approach, so it's trivial once you understand the principle.<p>\n<h3>Dynamic programming</h3>\n<p>As per usual with dynamic programming, we'll use a lookup table to store the subproblem results we find. This is the difference between this approach and the recursive approach, by the way. The recursive approach will just recalculate them every time.</p>\n<p>I solved this problem in Python, which I actually am not a huge fan for dynamic programming solutions, but I was a little nervous and using my \"main language for problems\" so to speak felt more comfortable at the time. Anyway, going through the solution:\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">len1 <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>string1<span class=\"token punctuation\">)</span>\nlen2 <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>string2<span class=\"token punctuation\">)</span>\ntable <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>len2<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>len1<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>This creates our look-up table. Using the main example, we’ll have 4 columns to represent string2, “ABC”, and our 7 rows for “ABCABC.” Why 4 and 7 instead of 3 and 6? You have to count the base case when the strings are empty.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>len1<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    table<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>len2<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    table<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span></code></pre></div>\n<p>Now we filled the first row and first column. They will look like this:</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"right\">” ”</th>\n<th>A</th>\n<th align=\"center\">B</th>\n<th align=\"right\">C</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">” ”</td>\n<td align=\"right\">1</td>\n<td>0</td>\n<td align=\"center\">0</td>\n<td align=\"right\">0</td>\n</tr>\n<tr>\n<td align=\"center\">A</td>\n<td align=\"right\">1</td>\n<td></td>\n<td align=\"center\"></td>\n<td align=\"right\"></td>\n</tr>\n<tr>\n<td align=\"center\">B</td>\n<td align=\"right\">1</td>\n<td></td>\n<td align=\"center\"></td>\n<td align=\"right\"></td>\n</tr>\n<tr>\n<td align=\"center\">C</td>\n<td align=\"right\">1</td>\n<td></td>\n<td align=\"center\"></td>\n<td align=\"right\"></td>\n</tr>\n<tr>\n<td align=\"center\">A</td>\n<td align=\"right\">1</td>\n<td></td>\n<td align=\"center\"></td>\n<td align=\"right\"></td>\n</tr>\n<tr>\n<td align=\"center\">B</td>\n<td align=\"right\">1</td>\n<td></td>\n<td align=\"center\"></td>\n<td align=\"right\"></td>\n</tr>\n<tr>\n<td align=\"center\">C</td>\n<td align=\"right\">1</td>\n<td></td>\n<td align=\"center\"></td>\n<td align=\"right\"></td>\n</tr>\n</tbody>\n</table>\n<p>This is the base table. Take a look at it and try to comprehend. If both are empty, then there’s one substring found, ” ” itself. If string2 is ” ”, the final count will always be one, since the only match will be ” “. If string2 is anything but empty, however, and string1 is empty, there won’t be any matches, because obviously you won’t find a string in something empty. It’s easy once it clicks!\nNow let’s go through the rest of the table and fill it. I will explain the logic afterwards.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> len1<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> len2<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> string1<span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> string2<span class=\"token punctuation\">[</span>j<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n      table<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> table<span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> table<span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span>  \n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n      table<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> table<span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span></code></pre></div>\n<p>I will refer to table[A1,B], for example, as the place where the first A of “ABCABC” and the B of “ABC” intersect for the purpose of clarity.\nWhen we go to table[A1,A], it’s a match. There’s an A in A1. So we add the values of the cell on top of it and the cell on top-left of it. So, for instance, when we go to table[B1,B], the result will be the sum of table[A1,B] and table[A1,A]. So, back to table[A1,A], we fill it with table[” “,A] + table[” ”,” ”]. Thats our first if clause.</p>\n<p>If they are no match, our else clause, we just copy the value to the top of our cell. So when we have table[B1,A], there’s no match, so it just copies [A1, A], which is one. This way we carry forward our current result when there are no matches.</p>\n<p>Following the algorithm, the final table will be this:</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"right\">” ”</th>\n<th>A</th>\n<th align=\"center\">B</th>\n<th align=\"right\">C</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">” ”</td>\n<td align=\"right\">1</td>\n<td>0</td>\n<td align=\"center\">0</td>\n<td align=\"right\">0</td>\n</tr>\n<tr>\n<td align=\"center\">A</td>\n<td align=\"right\">1</td>\n<td>1</td>\n<td align=\"center\">0</td>\n<td align=\"right\">0</td>\n</tr>\n<tr>\n<td align=\"center\">B</td>\n<td align=\"right\">1</td>\n<td>1</td>\n<td align=\"center\">1</td>\n<td align=\"right\">0</td>\n</tr>\n<tr>\n<td align=\"center\">C</td>\n<td align=\"right\">1</td>\n<td>1</td>\n<td align=\"center\">1</td>\n<td align=\"right\">1</td>\n</tr>\n<tr>\n<td align=\"center\">A</td>\n<td align=\"right\">1</td>\n<td>2</td>\n<td align=\"center\">1</td>\n<td align=\"right\">1</td>\n</tr>\n<tr>\n<td align=\"center\">B</td>\n<td align=\"right\">1</td>\n<td>2</td>\n<td align=\"center\">3</td>\n<td align=\"right\">1</td>\n</tr>\n<tr>\n<td align=\"center\">C</td>\n<td align=\"right\">1</td>\n<td>2</td>\n<td align=\"center\">3</td>\n<td align=\"right\">4</td>\n</tr>\n</tbody>\n</table>\n<p>Take a moment to understand this. When you look at the B column, for example, you are looking at how many times the string “AB” will have a match on string1. The first “1” in this column is in  the B row, because AB is a perfect match for AB. Then it won’t change for a while, it’s 1 again because it’s “ABC”, which there’s still only one subsequence (ABc), and another 1 for “ABCA.” When we get to the second B in our rows, the string1 is “ABCAB”, and thus we have three matches for AB. ABcab, AbcaB, and abcAB.</p>\n<p>We finally have our final result at the end of our table. So we return it.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">return</span> table<span class=\"token punctuation\">[</span>len1<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>len2<span class=\"token punctuation\">]</span></code></pre></div>\n<p>The complete code is:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">countSubsequences</span><span class=\"token punctuation\">(</span>string1<span class=\"token punctuation\">,</span> string2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\">#initialize lengths and table size</span>\n  len1 <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>string1<span class=\"token punctuation\">)</span>\n  len2 <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>string2<span class=\"token punctuation\">)</span>\n  table <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>len2<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>len1<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token comment\">#base case when str1 or str2 is empty</span>\n  <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>len1<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    table<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span>  \n  <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>len2<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    table<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n\n  <span class=\"token comment\">#finish filling the table</span>\n  <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> len1<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> len2<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">if</span> string1<span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> string2<span class=\"token punctuation\">[</span>j<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n        table<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> table<span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> table<span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span>  \n      <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        table<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> table<span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span>\n\n  <span class=\"token comment\">#return last element</span>\n  <span class=\"token keyword\">return</span> table<span class=\"token punctuation\">[</span>len1<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>len2<span class=\"token punctuation\">]</span></code></pre></div>\n<p>This is O(NM) time and space solution, m and n being the length for each string.</p>\n<p></p>\n<h3>Final thoughts</h3>\n<p>That is a very hard problem to understand, but after it clicks it's really simple. I'm not sure how I feel about, for instance, having this in an interview. Dynamic programming, to me, seems less about algorithmic thinking and manipulation of data and more of having an \"A-HA!\" moment and going from there.\nIt's an interesting problem, though. I don't know how well I explained it. Probably not very! But, as I said before, it's very easy once it clicks.</p>","frontmatter":{"title":"Number of distinct subsequences of string2 in string1","date":"May 17, 2020","description":"Dynamic programming problem walkthrough"}}},"pageContext":{"slug":"/blog/counting-subsequences/","previous":{"fields":{"slug":"/blog/tony-stark/"},"frontmatter":{"title":"Tony Stark"}},"next":{"fields":{"slug":"/blog/backtracking/"},"frontmatter":{"title":"How the backtracking algorithm works"}}}}}